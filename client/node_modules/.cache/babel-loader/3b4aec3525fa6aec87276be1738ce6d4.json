{"ast":null,"code":"import _regeneratorRuntime from\"/home/nishant/Desktop/ongoing/shopify/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/nishant/Desktop/ongoing/shopify/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(getSnapShotFromUserAuth),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(signInWithGoogle),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(signInWithEmail),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(isUserAuthenticated),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(signOut),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(signUp),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(signInAfterSignup),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(onGoogleSignInStart),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(onEmailSignInStart),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(onCheckUserSession),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(onSignOutStart),_marked12=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpStart),_marked13=/*#__PURE__*/_regeneratorRuntime.mark(onSignupSuccess),_marked14=/*#__PURE__*/_regeneratorRuntime.mark(userSagas);import{takeLatest,put,call,all}from'redux-saga/effects';import UserActionTypes from'./user.types';import{signInSuccess,signInFailure,signOutSuccess,signOutFailure,signUpFailure,signUpSuccess}from'./user.actions';import{auth,googleProvider,createUserProfileDocument,getCurrentUser}from'../../firebase/firebase.util';export function getSnapShotFromUserAuth(userAuth,additionalData){var userRef,userSnapshot;return _regeneratorRuntime.wrap(function getSnapShotFromUserAuth$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return call(createUserProfileDocument,userAuth,additionalData);case 3:userRef=_context.sent;_context.next=6;return userRef.get();case 6:userSnapshot=_context.sent;_context.next=9;return put(signInSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 9:_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);_context.next=15;return put(signInFailure(_context.t0));case 15:case\"end\":return _context.stop();}}},_marked,null,[[0,11]]);}export function signInWithGoogle(){var _yield$auth$signInWit,user;return _regeneratorRuntime.wrap(function signInWithGoogle$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return auth.signInWithPopup(googleProvider);case 3:_yield$auth$signInWit=_context2.sent;user=_yield$auth$signInWit.user;_context2.next=7;return getSnapShotFromUserAuth(user);case 7:_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);_context2.next=13;return put(signInFailure(_context2.t0));case 13:case\"end\":return _context2.stop();}}},_marked2,null,[[0,9]]);}export function signInWithEmail(_ref){var _ref$payload,email,password,_yield$auth$signInWit2,user;return _regeneratorRuntime.wrap(function signInWithEmail$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_ref$payload=_ref.payload,email=_ref$payload.email,password=_ref$payload.password;_context3.prev=1;_context3.next=4;return auth.signInWithEmailAndPassword(email,password);case 4:_yield$auth$signInWit2=_context3.sent;user=_yield$auth$signInWit2.user;_context3.next=8;return getSnapShotFromUserAuth(user);case 8:_context3.next=14;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](1);_context3.next=14;return put(signInFailure(_context3.t0));case 14:case\"end\":return _context3.stop();}}},_marked3,null,[[1,10]]);}export function isUserAuthenticated(){var userAuth;return _regeneratorRuntime.wrap(function isUserAuthenticated$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return getCurrentUser();case 3:userAuth=_context4.sent;if(userAuth){_context4.next=6;break;}return _context4.abrupt(\"return\");case 6:_context4.next=8;return getSnapShotFromUserAuth(userAuth);case 8:_context4.next=14;break;case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](0);_context4.next=14;return put(signInFailure(_context4.t0));case 14:case\"end\":return _context4.stop();}}},_marked4,null,[[0,10]]);}export function signOut(){return _regeneratorRuntime.wrap(function signOut$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return auth.signOut();case 3:_context5.next=5;return put(signOutSuccess());case 5:_context5.next=11;break;case 7:_context5.prev=7;_context5.t0=_context5[\"catch\"](0);_context5.next=11;return put(signOutFailure());case 11:case\"end\":return _context5.stop();}}},_marked5,null,[[0,7]]);}export function signUp(_ref2){var _ref2$payload,email,password,displayName,_yield$auth$createUse,user;return _regeneratorRuntime.wrap(function signUp$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_ref2$payload=_ref2.payload,email=_ref2$payload.email,password=_ref2$payload.password,displayName=_ref2$payload.displayName;_context6.prev=1;_context6.next=4;return auth.createUserWithEmailAndPassword(email,password);case 4:_yield$auth$createUse=_context6.sent;user=_yield$auth$createUse.user;_context6.next=8;return put(signUpSuccess({user:user,additionalData:{displayName:displayName}}));case 8:_context6.next=14;break;case 10:_context6.prev=10;_context6.t0=_context6[\"catch\"](1);_context6.next=14;return put(signUpFailure());case 14:case\"end\":return _context6.stop();}}},_marked6,null,[[1,10]]);}export function signInAfterSignup(_ref3){var _ref3$payload,user,additionalData;return _regeneratorRuntime.wrap(function signInAfterSignup$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_ref3$payload=_ref3.payload,user=_ref3$payload.user,additionalData=_ref3$payload.additionalData;_context7.next=3;return getSnapShotFromUserAuth(user,additionalData);case 3:case\"end\":return _context7.stop();}}},_marked7);}export function onGoogleSignInStart(){return _regeneratorRuntime.wrap(function onGoogleSignInStart$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START,signInWithGoogle);case 2:case\"end\":return _context8.stop();}}},_marked8);}export function onEmailSignInStart(){return _regeneratorRuntime.wrap(function onEmailSignInStart$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return takeLatest(UserActionTypes.EMAIL_SIGN_IN_START,signInWithEmail);case 2:case\"end\":return _context9.stop();}}},_marked9);}export function onCheckUserSession(){return _regeneratorRuntime.wrap(function onCheckUserSession$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return takeLatest(UserActionTypes.CHECK_USER_SESSION,isUserAuthenticated);case 2:case\"end\":return _context10.stop();}}},_marked10);}export function onSignOutStart(){return _regeneratorRuntime.wrap(function onSignOutStart$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return takeLatest(UserActionTypes.SIGN_OUT_START,signOut);case 2:case\"end\":return _context11.stop();}}},_marked11);}export function onSignUpStart(){return _regeneratorRuntime.wrap(function onSignUpStart$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return takeLatest(UserActionTypes.SIGN_UP_START,signUp);case 2:case\"end\":return _context12.stop();}}},_marked12);}export function onSignupSuccess(){return _regeneratorRuntime.wrap(function onSignupSuccess$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return takeLatest(UserActionTypes.SIGN_UP_SUCCESS,signInAfterSignup);case 2:case\"end\":return _context13.stop();}}},_marked13);}export function userSagas(){return _regeneratorRuntime.wrap(function userSagas$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return all([call(onGoogleSignInStart),call(onEmailSignInStart),call(onCheckUserSession),call(onSignOutStart),call(onSignUpStart),call(onSignupSuccess)]);case 2:case\"end\":return _context14.stop();}}},_marked14);}","map":{"version":3,"sources":["/home/nishant/Desktop/ongoing/shopify/client/src/redux/user/user.saga.js"],"names":["getSnapShotFromUserAuth","signInWithGoogle","signInWithEmail","isUserAuthenticated","signOut","signUp","signInAfterSignup","onGoogleSignInStart","onEmailSignInStart","onCheckUserSession","onSignOutStart","onSignUpStart","onSignupSuccess","userSagas","takeLatest","put","call","all","UserActionTypes","signInSuccess","signInFailure","signOutSuccess","signOutFailure","signUpFailure","signUpSuccess","auth","googleProvider","createUserProfileDocument","getCurrentUser","userAuth","additionalData","userRef","get","userSnapshot","id","data","signInWithPopup","user","payload","email","password","signInWithEmailAndPassword","displayName","createUserWithEmailAndPassword","GOOGLE_SIGN_IN_START","EMAIL_SIGN_IN_START","CHECK_USER_SESSION","SIGN_OUT_START","SIGN_UP_START","SIGN_UP_SUCCESS"],"mappings":"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","sourcesContent":["import { takeLatest , put, call,all } from 'redux-saga/effects';\nimport UserActionTypes from './user.types';\nimport { signInSuccess,signInFailure, signOutSuccess, signOutFailure, signUpFailure,signUpSuccess} from './user.actions';\nimport { auth , googleProvider, createUserProfileDocument,getCurrentUser }from '../../firebase/firebase.util';\n\nexport function* getSnapShotFromUserAuth(userAuth,additionalData){\n    try{\n        const userRef=yield call(createUserProfileDocument,userAuth,additionalData);\n        const userSnapshot=yield userRef.get();\n        yield put(\n            signInSuccess({id:userSnapshot.id,...userSnapshot.data()}));\n    }catch(error){\n        yield put(signInFailure(error));\n    }   \n}\n\nexport function* signInWithGoogle(){\n    try{\n        const {user}=yield auth.signInWithPopup(googleProvider);\n        yield getSnapShotFromUserAuth(user);\n    }catch(error){\n        yield put(signInFailure(error));\n    }\n} \n\nexport function* signInWithEmail({payload:{email,password}}){\n    try{\n        const { user }=yield auth.signInWithEmailAndPassword(email  ,password);\n       yield getSnapShotFromUserAuth(user);\n    }catch(error){\n        yield put(signInFailure(error));\n    }\n}\n\nexport function* isUserAuthenticated(){\n    try{\n        const userAuth=yield getCurrentUser();\n        if(!userAuth) return;\n        yield getSnapShotFromUserAuth(userAuth);\n    }catch(e){\n        yield put(signInFailure(e))\n    }\n}\n\nexport function* signOut(){\n    try{\n        yield auth.signOut();\n        yield put(signOutSuccess());\n    }catch(error){\n        yield put(signOutFailure());\n    }\n}\nexport function* signUp({payload:{email,password,displayName}}){\n    try{\n        const { user }=yield auth.createUserWithEmailAndPassword(\n            email,\n            password\n        );\n        yield put(signUpSuccess({user,additionalData:{displayName}}));\n    }catch(error){\n        yield put(signUpFailure());\n    }\n}\nexport function* signInAfterSignup({payload:{user,additionalData}}){\n    yield getSnapShotFromUserAuth(user,additionalData);\n}\n\nexport function* onGoogleSignInStart(){\n    yield takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START,signInWithGoogle)\n}\nexport function* onEmailSignInStart(){\n    yield takeLatest(UserActionTypes.EMAIL_SIGN_IN_START,signInWithEmail)\n}\n\nexport function* onCheckUserSession(){\n    yield takeLatest(UserActionTypes.CHECK_USER_SESSION,isUserAuthenticated)\n}\n\nexport function* onSignOutStart(){\n    yield takeLatest(UserActionTypes.SIGN_OUT_START,signOut)\n}\n\nexport function* onSignUpStart(){\n    yield takeLatest(UserActionTypes.SIGN_UP_START,signUp)\n}\n\nexport function* onSignupSuccess(){\n    yield takeLatest(UserActionTypes.SIGN_UP_SUCCESS,signInAfterSignup)\n}\n\nexport function* userSagas(){\n    yield all([\n        call(onGoogleSignInStart),\n        call(onEmailSignInStart),\n        call(onCheckUserSession),\n        call(onSignOutStart),\n        call(onSignUpStart),\n        call(onSignupSuccess)\n    ])\n} \n"]},"metadata":{},"sourceType":"module"}